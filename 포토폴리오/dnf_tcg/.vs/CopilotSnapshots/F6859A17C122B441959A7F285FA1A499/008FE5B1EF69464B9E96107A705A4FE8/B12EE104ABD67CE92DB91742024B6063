using System;

namespace DnfTcg.Models
{
    public enum CardType
    {
        Weapon,
        Armor,
        Skill,
        Monster,
        Effect,
        LevelUp,
    }

    public abstract class Card
    {
        public string Name { get; set; }
        public int LevelRequirement { get; set; }
        public CardType Type { get; protected set; }

        public abstract void Play(Player self, Player enemy);
    }

    public class LevelUpCard : Card
    {
        public LevelUpCard()
        {
            Name = "레벨업";
            LevelRequirement = 0;
            Type = CardType.LevelUp;
            
        }

        public override void Play(Player self, Player enemy)
        {
            self.Level += 10; //레벨업 카드당 레벨업 
            self.UpdateCubeShards(); // 큐브 지급 로직
            self.Field.LevelUpCard = this;
            Console.WriteLine($"{self.Name} used Level Up! New level: {self.Level}");
        }
    }

    public class WeaponCard : Card
    {
        public int AttackBonus { get; set; }

        public WeaponCard(string name, int levelReq, int atkBonus)
        {
            Name = name;
            LevelRequirement = levelReq;
            AttackBonus = atkBonus;
            Type = CardType.Weapon;
        }

        public override void Play(Player self, Player enemy)
        {
            // Equip behaves: if a weapon is currently equipped on field then move it to graveyard
            if (self.Field.Weapon != null)
            {
                self.Graveyard.Add(self.Field.Weapon);
            }

            self.EquipWeapon(this);
            self.Field.Weapon = this; // persistent on field
        }
    }

    public class ArmorCard : Card
    {
        public int DefenseBonus { get; set; }

        public ArmorCard(string name, int levelReq, int defBonus)
        {
            Name = name;
            LevelRequirement = levelReq;
            DefenseBonus = defBonus;
            Type = CardType.Armor;
        }

        public override void Play(Player self, Player enemy)
        {
            // If armor present, move old to graveyard
            if (self.Field.Armor != null)
            {
                self.Graveyard.Add(self.Field.Armor);
            }

            self.EquipArmor(this);
            self.Field.Armor = this;
        }
    }

}
